<div id="navbar" class="content-container">
  <div class="content flex-row">
    <img class="logo" src="{{ env.assetPath }}assets/images/logo.png" alt="Broad Institute Logo">

    <div class="navbar-links flex-row">
      <button *ngFor="let link of navbarLinks; let i = index"
        class="navbar-link flex-col"
        [class.active]="link.id === activeSection"
        (click)="scrollToId(link.id, $event)">
        {{ link.title }}
      </button>
    </div>

    <img class="terra-logo" src="{{ env.assetPath }}assets/images/powered-by-terra.png" alt="Powered by Terra">
  </div>
</div>

<div id="header-container" class="content-container">
  <div class="content flex-row">
    <h1 class="flex-row">
      Broad Institute COVID-19 Viral Sequencing<br/>
      and Genomics Surveillance
    </h1>
  
    <div class="stat-box">
      <div class="label">Last Updated:</div>
      <div class="value">04/19/21</div>
      <div class="detail">Updated Weekly</div>
    </div>
  
    <div class="stat-box stat-box-accent flex-col">
      <div class="flex-row">
        <div class="margin-right-10">
          <div class="label">Total Samples Sequenced:</div>
          <div class="value">3,017</div>
        </div>
    
        <div>
          <div class="label">Percent Sequenced:</div>
          <div class="value">15%</div>
        </div>
      </div>
  
      <div class="detail">*Percent of positive diagnostic tests sequenced this week</div>
    </div>
  </div>
</div>

<div id="introduction-container" class="content-container">
  <div class="content flex-row">
    <div class="description" data-aos="fade-in">
      The Broad Institute is sequencing the genomes of SARS-CoV-2 viruses
      from residual diagnostic samples to monitor for known and emerging
      variants of concern, and to support the public health response to
      COVID-19.
    </div>

    <div class="info-card" data-aos="fade-left" data-aos-delay="300 ">
      <div class="flex-row">
        <img src="{{ env.assetPath }}assets/images/states-served.png" alt="Map of NorthEast USA">

        <div class="padding-left-30">
          <h2>States we serve</h2>
        
          <div>
            The majority of samples sequenced are residual diagnostic samples from the
            <a class="btn-link" href="#">Broad's large scale testing platform</a>. Many of these samples
            come from Massachusetts and the Northeast region more broadly. We also 
            receive samples from external contributors including hospitals, public
            health departments, diagnostic labs and research labs.
          </div>
        </div>
      </div>
      <div class="state-list flex-col">
        <div *ngFor="let state of statesServed" class="state-container flex-row">
          <div class="state-icon" [attr.aria-hidden]="true" [style.transform]="state.rotation">{{ state.glyph }}</div> 
          <span>{{ state.name }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="scaling-container" class="content-container content-container-merge" data-aos="fade-up">
  <div class="content">
    <h2>Scaling up viral sequencing at the Broad Institute</h2>

    <div class="flex-row">
      <div class="description">
        <p>We are scaling our ability to sequence SARS-CoV-2 from COVID-positive 
        diagnostic samples. Here we show the number of samples being processed 
        each week at the Broad. We strive to generate and share data within 14 
        days of sample collection. We work with public health officials and 
        epidemiologists to ensure our sampling strategy is representative and 
        provides useful information about priorities for the COVID-19 response.</p>

        <p><strong>Note:</strong> These numbers reflect only samples sequenced at 
        the Broad Institute and do not include samples sequenced by other 
        sources. Numbers may differ from other public dashboards due to time 
        lags in updating across multiple sites. This dashboard is updated 
        weekly.</p>

        <p>For complete reporting of variants, please visit the <a class="btn-link bold" href="#">
          CDC - US COVID-19 Cases Caused by Variants
        </a></p>
      </div>

      <div class="flex-col margin-top-20">
        <button mat-stroked-button color="primary" (click)="toggleCumulative()">
          {{ scalingChartMode === 'combined' ? 'Hide' : 'Show'}} Cumulative
        </button>
        <plotly-plot [divId]="scalingChartId" [data]="scalingChart.data" [layout]="scalingChart.layout"></plotly-plot>
      </div>
    </div>
  </div>
</div>

<div id="broad-container" class="content-container content-container-accent" data-aos="fade-up">
  <div class="content">
    <h2>The Broad Institute's COVID-19 viral sequencing effort</h2>

    <div class="margin-top-25">
      With support from the CDC, the Broad has launched an effort to perform large-scale 
      sequencing of SARS-CoV-2 for variant surveillance and pbulic health response in the 
      Northeast. The Viral Genomics Group and Genomics Platform are working together to 
      sequence the virus from thousands of COVID-19 positive samples each week from the 
      institute's diagnostics lab, with bioinformatics support from the Data Sciences 
      Platform. The results are currently being shared with public health partners to help 
      slow the spread of concerning variants, and with the scientific community to learn 
      more about the evolution and spread of SARS-CoV-2.
    <br/>
    Learn more in a <a class="btn-link-white" href="#">Broad news story and video</a>.</div>
  </div>
</div>

<div id="methods-container" class="content-container" data-aos="fade-up">
  <div class="content">
    <h2>COVID-19 variant tracking</h2>

    <p><a class="btn-link" href="#"><i class="fa fa-external-link"></i> CDC.gov SARS-CoV-2 Variant Classifications and Definitions</a></p>

    <div class="margin-top-5">
      The CDC defines SARS-Cov-2 variants according to three classes:
    
      <div class="margin-top-15 margin-bottom-15">
        <strong>
          Variant of Interest<br/>
          Variant of Concern<br/>
          Variant of High Consequence<br/>
        </strong>
      </div>
    </div>

    <div>
      Currently the B.1.1.7, B.1.351, B.1.427, and B.1.429 variants circulating in the 
      United States are classified as Variants of Concern.<br/>
      The B.1.525, B.1.526, and P.2 viral lineages are classified as Variants of Interest.
    </div>

    <p>As of now there are no viral lineages classified as Variants of High Consequence. 
      We are tracking known Variants or Concern and of Interest. The numbers of each detected 
      are reported here. We are also monitoring the genomic data for new variants worthy of 
      additional investigation and monitoring as possible emerging threats.</p>

    <p><strong>Note:</strong> These numbers reflect only samples sequenced at the Broad 
      Institute and do not include samples sequenced by other sources. Numbers may differ 
      from other public dashboards due to time lags in updating across multiple sites. This 
      dashboard is updated weekly.</p>

    <p>For complete reporting of variants, please visit the <a class="btn-link bold" href="#">CDC - US COVID-19 
      Cases Caused by Variants</a></p>
  </div>
</div>

<div id="variants-container" class="content-container" data-aos="fade-up">
  <div class="content">
    <h2>Weekly counts of variants detected at the Broad Institute</h2>
    <div class="flex-row">
      <div class="margin-right-30">
        <plotly-plot [divId]="variantsChartId" [data]="variantsChart.data" [layout]="variantsChart.layout"></plotly-plot>
      </div>

      <div class="chart-controls">
        <div class="control-group" *ngFor="let controlGroup of variantsData.groups">
          <div class="flex-row">
            <mat-slide-toggle color="primary"
              [(ngModel)]="controlGroup.visible"
              [disabled]="controlGroup.values.length === 0"
              (change)="toggleGroupVisibility(controlGroup)">
            </mat-slide-toggle>
            <label class="margin-left-15">{{ controlGroup.title }}</label>
          </div>
          <div class="margin-left-50 padding-bottom-10">
            <div *ngIf="controlGroup.values?.length === 0"
              class="label subtitle-accent margin-top-10 margin-bottom-10">
              There are currently no reported {{ controlGroup.title }}
            </div>

            <div *ngFor="let value of controlGroup.values" class="flex-row margin-top-10 margin-bottom-10">
              <i class="fa fa-circle margin-right-5" [style.color]="value.color"></i>
              <div class="label margin-left-15">
                <div class="name">{{ value.name }}</div>
                <div class="subtitle margin-top-5">{{ value.desc }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="resources-container" class="content-container content-container-alt" data-aos="fade-up">
  <div class="content">
    <h2>More resources</h2>

    <div class="flex-row">
      <div class="terra-resource">
        <img src="{{ env.assetPath }}assets/images/terra-logo.png" width=200>
        <h3>Terra Covid Workspaces</h3>
        <div class="margin-top-10">
          Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor 
          incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud 
          exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
        </div>
        <a class="btn-link bold" href="#"><i class="fa fa-external-link"></i> COVID-19_Broad_virl_NGS</a><br>
        <a class="btn-link bold" href="#"><i class="fa fa-external-link"></i> COVID-19_cross_tissue_analysis</a>
      </div>

      <div class="broad-resource">
        <img src="{{ env.assetPath }}assets/images/resources-2.png" height=200>
        <h3>Broad SARS Cov-2 Auspice</h3>

        <div class="margin-top-10">
          View the Broad's SARS-CoV-2 interactive visualizations built using Auspice, a 
          tool from the Fred Hutch and the Bedford Lab.
        </div>
        <a class="btn-link bold" href="#">Read More</a><br/>
        <a class="btn-link bold" href="#"><i class="fa fa-external-link"></i> auspice.broadinstitute.org</a>
      </div>
    </div>
  </div>
</div>

<div id="acknowledgments-container" class="content-container content-container-black">
  <div class="content">
    <img src="{{ env.assetPath }}assets/images/cdc-logo.png" alt="CDC: Centers for Disease Control and Prevention">

    <h2>Acknowledgements</h2>
    <div class="flex-row">
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor 
        incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud 
        exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
      </p>

      <p>
        Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat 
        nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui 
        officia deserunt mollit anim id est laborum.
      </p>
    </div>
  </div>
</div>
